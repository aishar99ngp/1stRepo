utility functions for version two